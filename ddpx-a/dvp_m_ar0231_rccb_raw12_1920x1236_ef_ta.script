
#  Copyright (c) 2018, NVIDIA CORPORATION.  All rights reserved.
#
#  NVIDIA Corporation and its licensors retain all intellectual property
#  and proprietary rights in and to this software and related documentation
#  and any modifications thereto.  Any use, reproduction, disclosure or
#  distribution of this software and related documentation without an express
#  license agreement from NVIDIA Corporation is strictly prohibited.
#
# Capture Config Parameters
; Interface: csi-ef # csi-ef for DPHY, trio-ef for CPHY
; Input Format: raw12
; Resolution: 1920x1236
; CSI Lanes: 4
; I2C Device: 1
; Sensor Address: 0x20
; Deserializer Address: 0x52

52 0006 01 # Enable linkes - bit 0 : link 0, bit 1 : link 1, bit 2 : link 2, bit 3 : link3
52 0010 11
52 0011 11
52 0018 0F
; Delay 100ms

# Turn on HIM on MAX96712
52 0B06 EF
52 0C06 EF
52 0D06 EF
52 0E06 EF
# *CLINK should be up if SER is with HIM at power up; Otherwise continue.
# Enable everse channel cfg and turn on local I2C ack
52 0B0D 81
52 0C0D 81
52 0D0D 81
52 0E0D 81
# Turn off HIM on Ser
80 4D 40
; Delay 10ms
# Turn off HIM on MAX96712
52 0B06 6F
52 0C06 6F
52 0D06 6F
52 0E06 6F
52 0018 0F
; Delay 100ms
# Manually override of reverse channel pulse length
52 14C5 AA
52 15C5 AA
52 16C5 AA
52 17C5 AA
# Manually override of reverse channel rise fall time setting
52 14C4 8A
52 15C4 8A
52 16C4 8A
52 17C4 8A
# Manually override TxAmp
52 1495 88
52 1595 88
52 1695 88
52 1795 88
# Enable config link on Ser
80 04 43
; Delay 5ms
# * CLINK should be up
# Disable forward control channel
52 0B04 02
52 0C04 02
52 0D04 02
52 0E04 02
; Delay 5ms
# Turn on HIM on Ser
80 4D C0
; Delay 5ms
# Turn on HIM on MAX96712
52 0B06 EF
52 0C06 EF
52 0D06 EF
52 0E06 EF
# Manually override of reverse channel pulse length to default
52 14C5 40
52 15C5 40
52 16C5 40
52 17C5 40
# Manually override of reverse channel rise fall time setting to default
52 14C4 40
52 15C4 40
52 16C4 40
52 17C4 40
# Manually override TxAmp to default
52 1495 69
52 1595 69
52 1695 69
52 1795 69
# Enable forward control channel
52 0B04 03
52 0C04 03
52 0D04 03
52 0E04 03
# Enable Packet-based control channel
52 0B08 25
; Delay 10ms
52 0C08 25
; Delay 10ms
52 0D08 25
; Delay 10ms
52 0E08 25
; Delay 10ms
# Disable HS DE processing
52 0B0F 01
52 0C0F 01
52 0D0F 01
52 0E0F 01
# i2c_remote_master_timeout
80 99 0F

52 08A0 24
52 08A2 F4
# DPHY 4 lanes
52 090A C0 # PHY C
52 094A C0 # PHY D
52 098A C0 # PHY E
52 09CA C0 # PHY F
# CPHY 4 trios
#52 090A E0 # PHY C
#52 094A E0 # PHY D
#52 098A E0 # PHY E
#52 09CA E0 # PHY F
52 08A3 E4
52 08A4 E4
52 0415 39
52 0418 39
52 041B 39
52 041E 39

# Set prebegin phase, post length and prepare for CPHY mode
# This is a requirement for CPHY periodic calibration
# t3_prebegin = (63 + 1) * 7 = 448 UI
#52 08AD 3F
# Bit[6:2] = t3_post = (31 + 1) * 7 = 224 UI
# Bit[1:0] = t3_prepare = 86.7ns
#52 08AE 7F

# RAW12 software override for all pipes since connected GMSL1 is under parallel mode
52 040B 62
52 040C 00
52 040D 00
52 040E AC
52 040F BC
52 0410 B0
52 0411 6C
52 0412 30
52 0415 F9
52 0418 F9

52 090B 07
52 092D 15 # CSI2 controller 1
52 090D 2C
52 090E 2C
52 090F 00
52 0910 00
52 0911 01
52 0912 01

52 094B 07
52 096D 15 # CSI2 controller 1
52 094D 2C
52 094E 6C
52 094F 00
52 0950 40
52 0951 01
52 0952 41

52 098B 07
52 09AD 15 # CSI2 controller 1
52 098D 2C
52 098E AC
52 098F 00
52 0990 80
52 0991 01
52 0992 81

52 09CB 07
52 09ED 15 # CSI2 controller 1
52 09CD 2C
52 09CE EC
52 09CF 00
52 09D0 C0
52 09D1 01
52 09D2 C1

# sensor initial AR0231 for V7
# Disable Streaming
20 301A 10 58 # RESET_REGISTER
; Delay 1ms
# Exposure control
20 3362 00 00 # C_GAIN 1.0
20 3364 00 60 # DCG_TRIM
20 3366 77 77 # A_GAIN 1.0
20 3308 02 00 # D_GAIN 2.0
# WB control
20 3056 00 80 # GREEN_R_GAIN, 1.0
20 3058 01 40 # BLUE_GAIN, 2.5
20 305A 00 E7 # RED_GAIN, 1.8
20 305C 00 80 # GREEN_B_GAIN, 1.0
# AE ROI setting, overlap ROIs for Gr(Cr)RB
20 306E 90 10 # DATA_PATH_SELECT, BIT[7]:enable LOG stats
20 3140 00 20 # RIO1_X_START_OFFSET
20 3142 00 F0 # RIO1_Y_START_OFFSET
20 3144 07 40 # RIO1_X_SIZE
20 3146 02 94 # RIO1_Y_SIZE
20 3240 00 20 # RIO2_X_START_OFFSET
20 3242 00 F0 # RIO2_Y_START_OFFSET
20 3244 07 40 # RIO2_X_SIZE
20 3246 02 94 # RIO2_Y_SIZE
20 3264 00 20 # RIO3_X_START_OFFSET
20 3266 00 F0 # RIO3_Y_START_OFFSET
20 3268 07 40 # RIO3_X_SIZE
20 326A 02 94 # RIO3_Y_SIZE
20 3270 01 E0 # GRID_RIO_X1_START_OFFSET
20 3272 03 C0 # GRID_RIO_X2_START_OFFSET
20 3274 05 A0 # GRID_RIO_X3_START_OFFSET
20 3276 01 2C # GRID_RIO_Y1_START_OFFSET
20 3278 02 58 # GRID_RIO_Y2_START_OFFSET
20 327A 03 84 # GRID_RIO_Y3_START_OFFSET
20 327C 71 70 # RIO1 = Gr(Cr); ROI2 = R
20 327E 70 72 # RIO3 = B
20 3290 0F C0 # T3_BARRIER_C0, 4032
20 3292 0F C0 # T3_BARRIER_C1, 4032
20 3294 0F C0 # T3_BARRIER_C2, 4032
20 3296 0F C0 # T3_BARRIER_C3, 4032
# Design recomannended settings
20 3092 0C 24 # ROW_NOISE_CONTROL
20 30B0 09 02 # DIGITAL_TEST; 08 02?
20 3100 42 00 # DLO_CONTROL0; b[14]:enable DLO filter
20 3102 50 00 # DLO_CONTROL1
20 337A 0C 80 # DBLC_SCALE0
20 3506 33 33 # RESERVED_MFR_3506
20 3508 33 33 # RESERVED_MFR_3508
20 350C 05 5C # DAC_LD_12_13
20 3520 12 88 # DAC_LD_32_33
20 3522 88 0C # DAC_LD_34_35
20 3524 0C 12 # DAC_LD_36_37
20 352C 12 12 # DAC_LD_44_45
20 354A 00 7F # DAC_LD_74_75
20 3566 33 28 # DAC_LD_102_103
#Sequencer for V7, May 12
20 2512 80 00 # SEQ_CTRL_PORT
20 2510 09 05 # SEQ_DATA_PORT
20 2510 33 50
20 2510 20 04
20 2510 14 60
20 2510 15 78
20 2510 09 01
20 2510 7B 24
20 2510 FF 24
20 2510 FF 24
20 2510 EA 24
20 2510 10 22
20 2510 24 10
20 2510 15 5A
20 2510 09 01
20 2510 14 00
20 2510 24 FF
20 2510 24 FF
20 2510 24 EA
20 2510 23 24
20 2510 64 7A
20 2510 24 04
20 2510 05 2C
20 2510 40 0A
20 2510 FF 0A
20 2510 FF 0A
20 2510 10 08
20 2510 38 51
20 2510 14 40
20 2510 00 04
20 2510 08 01
20 2510 04 08
20 2510 11 80
20 2510 26 52
20 2510 15 18
20 2510 09 06
20 2510 13 48
20 2510 10 02
20 2510 10 16
20 2510 11 81
20 2510 11 89
20 2510 10 56
20 2510 12 10
20 2510 09 01
20 2510 0D 09
20 2510 14 13
20 2510 88 09
20 2510 2B 15
20 2510 88 09
20 2510 03 11
20 2510 D9 09
20 2510 12 14
20 2510 41 09
20 2510 03 12
20 2510 14 09
20 2510 01 10
20 2510 D6 12
20 2510 10 12
20 2510 12 12
20 2510 10 11
20 2510 DD 11
20 2510 D9 10
20 2510 56 09
20 2510 15 11
20 2510 DB 09
20 2510 15 11
20 2510 9B 09
20 2510 0F 11
20 2510 BB 12
20 2510 1A 12
20 2510 10 14
20 2510 60 12
20 2510 50 10
20 2510 76 10
20 2510 E6 09
20 2510 08 12
20 2510 40 12
20 2510 60 09
20 2510 29 0B
20 2510 09 04
20 2510 14 40
20 2510 09 23
20 2510 15 C8
20 2510 13 C8
20 2510 09 2C
20 2510 15 88
20 2510 13 88
20 2510 0C 09
20 2510 0C 14
20 2510 41 09
20 2510 11 12
20 2510 62 12
20 2510 60 11
20 2510 BF 11
20 2510 BB 10
20 2510 66 11
20 2510 FB 09
20 2510 35 11
20 2510 BB 12
20 2510 63 12
20 2510 60 14
20 2510 00 15
20 2510 00 11
20 2510 B8 12
20 2510 A0 12
20 2510 00 10
20 2510 26 10
20 2510 00 13
20 2510 00 11
20 2510 00 08
20 2510 30 53
20 2510 42 15
20 2510 40 13
20 2510 40 10
20 2510 02 10
20 2510 16 11
20 2510 81 11
20 2510 89 10
20 2510 56 12
20 2510 10 09
20 2510 01 0D
20 2510 08 15
20 2510 C0 15
20 2510 D0 13
20 2510 50 09
20 2510 13 13
20 2510 D0 09
20 2510 02 15
20 2510 C0 15
20 2510 C8 13
20 2510 C0 09
20 2510 05 15
20 2510 88 13
20 2510 80 09
20 2510 02 13
20 2510 88 09
20 2510 04 11
20 2510 C9 09
20 2510 08 14
20 2510 01 09
20 2510 0B 11
20 2510 D9 08
20 2510 14 00
20 2510 09 1A
20 2510 14 40
20 2510 09 03
20 2510 12 14
20 2510 09 01
20 2510 10 D6
20 2510 12 10
20 2510 12 12
20 2510 12 10
20 2510 11 DD
20 2510 11 D9
20 2510 10 56
20 2510 09 17
20 2510 11 DB
20 2510 09 13
20 2510 11 FB
20 2510 09 05
20 2510 11 BB
20 2510 12 1A
20 2510 12 10
20 2510 14 60
20 2510 12 50
20 2510 10 76
20 2510 10 E6
20 2510 09 01
20 2510 15 A8
20 2510 09 01
20 2510 13 A8
20 2510 12 40
20 2510 12 60
20 2510 09 25
20 2510 13 AD
20 2510 09 02
20 2510 09 07
20 2510 15 88
20 2510 09 01
20 2510 13 8D
20 2510 0B 09
20 2510 09 14
20 2510 40 09
20 2510 0B 13
20 2510 88 09
20 2510 1C 0C
20 2510 09 20
20 2510 12 62
20 2510 12 60
20 2510 11 BF
20 2510 11 BB
20 2510 10 66
20 2510 09 0A
20 2510 11 FB
20 2510 09 3B
20 2510 11 BB
20 2510 12 63
20 2510 12 60
20 2510 14 00
20 2510 15 08
20 2510 11 B8
20 2510 12 A0
20 2510 12 00
20 2510 10 26
20 2510 10 00
20 2510 13 00
20 2510 11 00
20 2510 43 7A
20 2510 06 09
20 2510 0B 05
20 2510 07 08
20 2510 41 37
20 2510 50 2C
20 2510 2C FE
20 2510 15 FE
20 2510 0C 2C
20 32E6 00 E0 # RESERVED_MFR_32E6
# FINE  INTEGRATION TIME MINS
20 1008 03 6F
20 100C 05 8F
20 100E 07 AF
20 1010 01 4F
# FINE CORRECTIONS
20 3230 03 12
20 3232 05 32
20 3234 07 52
20 3236 00 F2
# PLL 27MHz In -88MHz out
20 302A 00 06 # VT_PIX_CLK_DIV
20 302C 00 01 # VT_SYS_CLK_DIV
20 302E 00 09 # PRE_PLL_CLK_DIV
20 3030 00 B0 # PLL_MULTIPLIER
20 3036 00 08 # OP_WORD_CLK_DIV
20 3038 00 01 # OP_SYS_CLK_DIV
# Readout Mode Configuration
20 3040 00 00 # READ_MODE
20 3042 00 00 # EXTRA_DELAY
20 3044 04 00 # DARK_CONTROL
20 3064 19 82 # SMIA_TEST, enable TOP/BOTTOM EMB
20 3180 00 80 # DELTA_DK_CONTROL
20 33E0 00 80 # TEST_ASIL_ROWS, top emb
20 33E4 00 00 # VERT_SHADING_CONTROL
# Timing
20 3032 00 00
20 3400 00 10
20 3402 0F 10
20 3404 09 70
# 3 exp Timing
20 3082 00 08 # OPERATION_MODE_CTRL
20 30B4 00 07 # TEMPSENS0_CTL, enable temperature sensor0
20 30B8 00 07 # TEMPSENS1_CTL, enable temperature sensor1
20 30BA 11 E2 # DIGITAL_CTRL
# Exposure
20 3238 87 77 # EXPOSURE_RATIO, use_reg
20 3012 03 00 # COARSE_INTEGRATION_TIME_
20 3212 00 30 # COARSE_INTEGRATION_TIME_2
20 3216 00 03 # COARSE_INTEGRATION_TIME_3
20 32EA 3C 0E # SHUT_CTRL
20 32EC 72 A1 # SHUT_CTRL2
# GPIO control # ENABLE GPIO3 to trigger fsync
20 340A 00 77 # GPIO_CONTROL1
20 340C 00 80 # GPIO_CONTROL2
20 30CE 01 20 # GRR_CONTROL1, enable synchronization
# Parallel HDR 12 bit Output
20 31D0 00 01 # COMPANDING
20 31AC 14 0C # DATA_FORMAT_BITS
20 31AE 00 01 # SERIAL_FORMAT
# fine integration time
20 3014 07 1A # FINE_INTEGRATION_TIME_
20 321E 05 8F # FINE_INTEGRATION_TIME2
20 3222 07 1A # FINE_INTEGRATION_TIME3
# Resolution related. 1920x1208
20 3002 00 00 # Y_ADDR_START_
20 3004 00 04 # X_ADDR_START_
20 3006 04 B7 # Y_ADDR_END_    y:1208
20 3008 07 83 # X_ADDR_END_    x:1920
20 300A 05 4A # VTS 1354
20 300C 08 72 # HTS 2162
# enable Streaming
20 301A 19 DC # RESET_REGISTER
#end of init sensor

# Enable the external synchornization
52 04A0 08
52 0B08 65
52 0C08 65
52 0D08 65
52 0E08 65
# Enable HVEN, HIBW, DBL on MAX96712 depends on applications
52 0B07 8C
; Delay 10ms
52 0C07 8C
; Delay 10ms
52 0D07 8C
; Delay 10ms
52 0E07 8C
; Delay 10ms
# Enable HVEN, HIBW, DBL on Ser depends on applications
80 07 C4
; Delay 10ms
80 06 AC # preemphasis setting 6.0 dB by default
; Delay 5ms
# Enable SER link
80 04 83
